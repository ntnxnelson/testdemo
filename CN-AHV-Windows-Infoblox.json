{"status":{},"spec":{"name":"CN-AHV-Windows-Infoblox","description":"This blueprint provides the ability to provision a Windows 2019 VM on AHV.  This blueprint requests an IP address from Infoblox and joins the domain.","resources":{"service_definition_list":[{"name":"Windows 2016","description":"","variable_list":[],"action_list":[{"type":"system","name":"action_create","description":"System action for creating an application","runbook":{"name":"c78ae03a_runbook","description":"","task_definition_list":[{"type":"DAG","name":"c2000e51_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"c2000e51_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_delete","description":"System action for deleting an application. Deletes created VMs as well","runbook":{"name":"dbb3f2bf_runbook","description":"","task_definition_list":[{"type":"DAG","name":"020a52ab_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"020a52ab_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_start","description":"System action for starting an application","runbook":{"name":"e470831a_runbook","description":"","task_definition_list":[{"type":"DAG","name":"ed3836fd_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"ed3836fd_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_stop","description":"System action for stopping an application","runbook":{"name":"3b46f2dc_runbook","description":"","task_definition_list":[{"type":"DAG","name":"89e71c14_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"89e71c14_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"system","name":"action_restart","description":"System action for restarting an application","runbook":{"name":"5828254d_runbook","description":"","task_definition_list":[{"type":"DAG","name":"b850c739_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"b850c739_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"user","name":"Initialize VM","description":"","runbook":{"name":"26aee80e_runbook","description":"","task_definition_list":[{"type":"DAG","name":"bf98f460_dag","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Enable Cred SSP","kind":"app_task"},"to_task_reference":{"name":"EnableRDP","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"EnableRDP","kind":"app_task"},"to_task_reference":{"name":"Join AD","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Join AD","kind":"app_task"},"to_task_reference":{"name":"Wait for Restart","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Enable Cred SSP","kind":"app_task"},{"name":"EnableRDP","kind":"app_task"},{"name":"Join AD","kind":"app_task"},{"name":"Wait for Restart","kind":"app_task"}],"variable_list":[],"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"EXEC","name":"Enable Cred SSP","description":"","attrs":{"type":"","script":"Write-Output \"Enabling CredSSP\"\n\n#Enable credssp for double-hop issues\nEnable-WSManCredSSP -Role Server -Force","script_type":"npsscript","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"EXEC","name":"EnableRDP","description":"","attrs":{"type":"","script":"reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" \/v fDenyTSConnections \/t REG_DWORD \/d 0 \/f","script_type":"npsscript","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"EXEC","name":"Join AD","description":"","attrs":{"type":"","script":"#\n# Task Name: Domain Join\n#\n# Variables:\n#\n#             domname\t\t- This variable passes the name of the domain to join to the script.\n#                                                                                             \n#             oupath\t\t- This variable passes the OU path to add the computer object to in AD.\n#                                                                                             \n#             uname\t        - This is the user name with permissions to join computers to the domain.\n#                                                                                             \n#             passwd\t    - This is the password for the domain join user.\n#\n\n$compName = $env:computername\n$domname = \"@@{domain_name}@@\"\n$uname = \"@@{Domain Join.username}@@\"\n$passwd = ConvertTo-SecureString -AsPlainText '@@{Domain Join.secret}@@' -Force\n\n$cred = New-Object System.Management.Automation.PSCredential ($uname,$passwd)\n\nWrite-Output \"Attempting to join $compName to $domname\"\nWrite-Output \"\"\n\nTry {\n\n\t# join domain\n    Add-Computer -DomainName $domname -Credential $cred -Restart -Force -ErrorAction Stop\n\n} Catch {\n\n\tWrite-Output \"Joining domain failed\"\n\t# send exit code to Calm to stop provisioning process\n\texit 1\n    \n}\n\nWrite-Output \"$compName succesfully joined to $domname\"\nWrite-Output \"\"\n","script_type":"npsscript","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"DELAY","name":"Wait for Restart","description":"","attrs":{"type":"","interval_secs":60},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"bf98f460_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"user","name":"Decommission","description":"","runbook":{"name":"3b04a9c4_runbook","description":"","task_definition_list":[{"type":"DAG","name":"c8b0669d_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[{"name":"Remove VM From Domain","kind":"app_task"}],"variable_list":[],"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"EXEC","name":"Remove VM From Domain","description":"","attrs":{"type":"","script":"Write-Output \"Removing VM from AD\"\nWrite-Output \"\"\n\n$uname = \"@@{Domain Join.username}@@\"\n$passwd = ConvertTo-SecureString -AsPlainText '@@{Domain Join.secret}@@' -Force\n\nEnable-WindowsOptionalFeature -FeatureName ActiveDirectory-PowerShell -Online -All\nImport-Module ActiveDirectory\n\n$cred = New-Object System.Management.Automation.PSCredential ($uname,$passwd)\n\n$compName = $env:computername\n$compConfig = Get-WmiObject -Class Win32_ComputerSystem\n$compObj = Get-ADComputer -Identity $compName\n$compDN = $compObj.distinguishedname\n\nIf ($compConfig.PartOfDomain -eq $true) {\n\n\n\tTry {\n\n\t\t#Remove-Computer -UnjoinDomainCredential $cred -Force -Confirm:$false -ErrorAction Stop\n        \n        Remove-ADObject -Identity $compDN -Credential $cred -Confirm:$false -Verbose\n    \n\t} Catch {\n\n\t\tWrite-Output \"Removing VM from AD failed\"\n    \t#Send exit code to Calm to stop decom process\"\n \t\texit 1   \n\t}\n\nWrite-Output \"VM removed from AD\"\n\n}\n\nIf ($compConfig.PartOfDomain -ne $true) {\n\n\tWrite-Output \"$compName not part of domain, exiting\"\n\n}\n\n","script_type":"npsscript","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"c8b0669d_dag","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"user","name":"AgentInstalls","description":"","runbook":{"name":"2639f045_runbook","description":"","task_definition_list":[{"type":"DAG","name":"2e960ea1_dag","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[{"name":"Install SCOM Agent","kind":"app_task"}],"variable_list":[],"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"EXEC","name":"Install SCOM Agent","description":"","attrs":{"type":"","script":"$AppName = \"SCOM\"\nWrite-Output \"Installing $AppName Agent\"\n\n#Set argument list for install\n$CompName = $env:COMPUTERNAME\n$ArgList = '\/i C:\\Sources\\MOMAgent.msi \/qn \/l*v C:\\Windows\\temp\\MOMAgentinstall.log USE_SETTINGS_FROM_AD=0 MANAGEMENT_GROUP=SAMANGRP1 MANAGEMENT_SERVER_DNS=AUTOLABSCOM1000 ACTIONS_USE_COMPUTER_ACCOUNT=0 ACTIONSUSER=svc_ITMon USE_MANUALLY_SPECIFIED_SETTINGS=1 SET_ACTIONS_ACCOUNT=1 AcceptEndUserLicenseAgreement=1'\nWrite-Output \"Install arguments are $ArgList\"\n\n\n#Start install with arguments\n    Try {\n\n        New-PSDrive -Name \"FileSource\" -PSProvider \"FileSystem\" -Root @@{InstallSource}@@ -Verbose\n        If ( -not (Test-Path -Path \"C:\\Sources\")) {mkdir \"C:\\Sources\"}\n        Copy-Item -Path FileSource:\\SCOMAgent\\agent\\AMD64\\MOMAgent.msi -Destination C:\\Sources\\ -Force\n        \n        $InstallTask = Start-Process -FilePath C:\\windows\\system32\\msiexec.exe -ArgumentList $ArgList -PassThru -NoNewWindow\n        $Handle = $InstallTask.Handle\n        $InstallTask.WaitForExit();\n        $ExitCode = $InstallTask.ExitCode\n        \n           Write-Output \"$AppName installation successfully completed.\"\n        \n    } Catch {\n    \n        Write-Output \"$AppName install failed with exit code\" $ExitCode\n        \n        }\n        ","script_type":"npsscript","command_line_args":"","exit_status":[],"login_credential_local_reference":{"name":"Domain Join","kind":"app_credential"}},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"2e960ea1_dag","kind":"app_task"},"variable_list":[]},"critical":false}],"depends_on_list":[],"port_list":[],"singleton":false,"tier":""}],"published_service_definition_list":[],"substrate_definition_list":[{"type":"AHV_VM","name":"Windows_AHV","description":"","variable_list":[],"action_list":[{"type":"fragment","name":"pre_action_create","description":"","runbook":{"name":"cc49c6eb_runbook_cloned_0","description":"","task_definition_list":[{"type":"DAG","name":"0abf2002_dag_cloned_1","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Set VM Name","kind":"app_task"},"to_task_reference":{"name":"Create Host Record","kind":"app_task"},"edge_type":"user_defined"},{"type":"","from_task_reference":{"name":"Create Host Record","kind":"app_task"},"to_task_reference":{"name":"Get IP Address","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Set VM Name","kind":"app_task"},{"name":"Create Host Record","kind":"app_task"},{"name":"Get IP Address","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"SET_VARIABLE","name":"Set VM Name","description":"","attrs":{"type":"","script":"print(\"windows_vm_name=@@{vm_name_prefix}@@-@@{environment}@@-@@{calm_unique}@@\")","script_type":"static_py3","exit_status":[],"eval_scope":"local","eval_variables":["window_vm_name"]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"HTTP","name":"Create Host Record","description":"","attrs":{"type":"HTTP","method":"POST","connection_timeout":120,"headers":[],"url":"https:\/\/@@{infoblox_ip}@@\/wapi\/v2.7\/record:host","request_body":"{\n\t\"name\":\"@@{window_vm_name}@@.@@{domain_name}@@\",\n\t\"ipv4addrs\":[{\"ipv4addr\":\"func:nextavailableip:@@{network}@@\"}]\n}","content_type":"application\/json","expected_response_params":[{"type":"","code":201,"status":"SUCCESS"},{"type":"","code":404,"status":"FAILURE"}],"authentication":{"type":"basic_with_cred","credential_local_reference":{"name":"infoblox","kind":"app_credential"}},"response_paths":{"host_ref":"$"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":1},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"HTTP","name":"Get IP Address","description":"","attrs":{"type":"HTTP","method":"GET","connection_timeout":120,"headers":[],"url":"https:\/\/@@{infoblox_ip}@@\/wapi\/v2.7\/@@{host_ref}@@","request_body":"","content_type":"application\/json","expected_response_params":[{"type":"","code":200,"status":"SUCCESS"},{"type":"","code":404,"status":"FAILURE"}],"authentication":{"type":"basic_with_cred","credential_local_reference":{"name":"infoblox","kind":"app_credential"}},"response_paths":{"static_ip":"$.ipv4addrs[0].ipv4addr"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":1},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"0abf2002_dag_cloned_1","kind":"app_task"},"variable_list":[]},"critical":false},{"type":"fragment","name":"post_action_delete","description":"","runbook":{"name":"f2568bf8_runbook_cloned_0","description":"","task_definition_list":[{"type":"DAG","name":"d3d66891_dag_cloned_1","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[{"name":"Remove Host Record_cloned_1","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"HTTP","name":"Remove Host Record_cloned_1","description":"","attrs":{"type":"HTTP","method":"DELETE","connection_timeout":120,"headers":[],"url":"https:\/\/@@{infoblox_ip}@@\/wapi\/v2.7\/@@{host_ref}@@","request_body":"","content_type":"application\/json","expected_response_params":[{"type":"","code":200,"status":"SUCCESS"},{"type":"","code":404,"status":"SUCCESS"}],"authentication":{"type":"basic_with_cred","credential_local_reference":{"name":"infoblox","kind":"app_credential"}},"response_paths":{},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":1},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"d3d66891_dag_cloned_1","kind":"app_task"},"variable_list":[]},"critical":false}],"editables":{"create_spec":{"resources":{"nic_list":{"0":{"ip_endpoint_list":{"0":{"ip":true}},"subnet_reference":true}}}}},"create_spec":{"type":"","name":"@@{window_vm_name}@@","availability_zone_reference":null,"backup_policy":null,"cluster_reference":{"type":"","kind":"cluster","name":"SA-East","uuid":"00061e00-3dd7-7c0d-2685-ac1f6b3febf3"},"resources":{"type":"","nic_list":[{"type":"","nic_type":"NORMAL_NIC","subnet_reference":{"type":"","kind":"subnet","name":"","uuid":"d44378b6-cacd-440b-baea-4c257d78b589"},"network_function_nic_type":"INGRESS","mac_address":"","ip_endpoint_list":[{"type":"ASSIGNED","ip":"@@{static_ip}@@"}],"network_function_chain_reference":null,"vpc_reference":null}],"power_state":"ON","guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":2,"memory_size_mib":8192,"gpu_list":[],"parent_reference":null,"hardware_clock_timezone":"","account_uuid":"bf1648b2-8e89-47fa-940a-601b52d676fb","guest_customization":{"type":"","cloud_init":null,"sysprep":{"type":"","install_type":"PREPARED","unattend_xml":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<unattend xmlns=\"urn:schemas-microsoft-com:unattend\">\n   <settings pass=\"specialize\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <ComputerName>@@{name}@@<\/ComputerName>\n         <RegisteredOrganization>Nutanix<\/RegisteredOrganization>\n         <RegisteredOwner>Acropolis<\/RegisteredOwner>\n         <TimeZone>UTC<\/TimeZone>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <fDenyTSConnections>false<\/fDenyTSConnections>\n      <\/component>\n      <component xmlns=\"\" name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\" processorArchitecture=\"amd64\">\n         <UserAuthentication>0<\/UserAuthentication>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Networking-MPSSVC-Svc\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <FirewallGroups>\n            <FirewallGroup wcm:action=\"add\" wcm:keyValue=\"RemoteDesktop\">\n               <Active>true<\/Active>\n               <Profile>all<\/Profile>\n               <Group>@FirewallAPI.dll,-28752<\/Group>\n            <\/FirewallGroup>\n         <\/FirewallGroups>\n      <\/component>\n   <\/settings>\n   <settings pass=\"oobeSystem\">\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <UserAccounts>\n            <AdministratorPassword>\n               <Value>@@{Local Administrator.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/AdministratorPassword>\n         <\/UserAccounts>\n         <AutoLogon>\n            <Password>\n               <Value>@@{Local Administrator.secret}@@<\/Value>\n               <PlainText>true<\/PlainText>\n            <\/Password>\n            <Enabled>true<\/Enabled>\n            <Username>@@{Local Administrator.username}@@<\/Username>\n            <LogonCount>1<\/LogonCount>\n         <\/AutoLogon>\n         <FirstLogonCommands>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>cmd.exe \/c netsh advfirewall set allprofiles state off<\/CommandLine>\n               <Description>Win RM port open<\/Description>\n               <Order>1<\/Order>\n               <RequiresUserInput>true<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Enable-PSRemoting -SkipNetworkProfileCheck -Force\"<\/CommandLine>\n               <Description>Enable PS-Remoting<\/Description>\n               <Order>2<\/Order>\n               <RequiresUserInput>true<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Set-ExecutionPolicy -ExecutionPolicy RemoteSigned\"<\/CommandLine>\n               <Description>Enable Remote-Signing<\/Description>\n               <Order>3<\/Order>\n               <RequiresUserInput>false<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"winrm quickconfig -Force\"<\/CommandLine>\n               <Description>setup winrm<\/Description>\n               <Order>4<\/Order>\n               <RequiresUserInput>false<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Set-Item wsman:\\\\localhost\\\\client\\\\trustedhosts * -Force\"<\/CommandLine>\n               <Description>allow trusted hosts<\/Description>\n               <Order>5<\/Order>\n               <RequiresUserInput>false<\/RequiresUserInput>\n            <\/SynchronousCommand>\n            <SynchronousCommand wcm:action=\"add\">\n               <CommandLine>powershell -Command \"Restart-Service WinRM\"<\/CommandLine>\n               <Description>restart winRM<\/Description>\n               <Order>6<\/Order>\n               <RequiresUserInput>false<\/RequiresUserInput>\n            <\/SynchronousCommand>\n         <\/FirstLogonCommands>\n         <OOBE>\n            <HideEULAPage>true<\/HideEULAPage>\n            <SkipMachineOOBE>true<\/SkipMachineOOBE>\n         <\/OOBE>\n      <\/component>\n      <component xmlns:wcm=\"http:\/\/schemas.microsoft.com\/WMIConfig\/2002\/State\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\">\n         <InputLocale>en-US<\/InputLocale>\n         <SystemLocale>en-US<\/SystemLocale>\n         <UILanguageFallback>en-us<\/UILanguageFallback>\n         <UILanguage>en-US<\/UILanguage>\n         <UserLocale>en-US<\/UserLocale>\n      <\/component>\n   <\/settings>\n<\/unattend>\n","is_domain":false,"domain":"","domain_credential_reference":null,"dns_ip":"","dns_search_path":""}},"boot_config":{"type":"","boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"mac_address":"","boot_type":"LEGACY"},"disk_list":[{"type":"","data_source_reference":{"type":"","kind":"image","name":"windows-2019.qcow2","uuid":"4462e4db-1745-47cc-82d8-2926130f99f4"},"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"},"disk_size_mib":102400}],"serial_port_list":[]},"categories":{}},"os_type":"Windows","readiness_probe":{"login_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"},"connection_type":"POWERSHELL","connection_port":5985,"delay_secs":"60","retries":"5","address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","disable_readiness_probe":false,"connection_protocol":"http"}}],"package_definition_list":[{"type":"DEB","name":"Package1_cloned_0","description":"","variable_list":[],"action_list":[],"service_local_reference_list":[{"name":"Windows 2016","kind":"app_service"}],"version":"","options":{"type":"","install_runbook":{"name":"4320a102_runbook_cloned_1_cloned_0","description":"","task_definition_list":[{"type":"DAG","name":"700fe1a4_dag_cloned_1_cloned_1","description":"","attrs":{"type":"","edges":[{"type":"","from_task_reference":{"name":"Initialize VM_cloned_1","kind":"app_task"},"to_task_reference":{"name":"AgentInstalls_cloned_1","kind":"app_task"},"edge_type":"user_defined"}]},"child_tasks_local_reference_list":[{"name":"Initialize VM_cloned_1","kind":"app_task"},{"name":"AgentInstalls_cloned_1","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Package1_cloned_0","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"CALL_RUNBOOK","name":"Initialize VM_cloned_1","description":"","attrs":{"type":"CALL_RUNBOOK","runbook_reference":{"name":"26aee80e_runbook","kind":"app_runbook"},"inarg_list":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"CALL_RUNBOOK","name":"AgentInstalls_cloned_1","description":"","attrs":{"type":"CALL_RUNBOOK","runbook_reference":{"name":"2639f045_runbook","kind":"app_runbook"},"inarg_list":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"700fe1a4_dag_cloned_1_cloned_1","kind":"app_task"},"variable_list":[]},"uninstall_runbook":{"name":"7b0c6c56_runbook_cloned_1_cloned_0","description":"","task_definition_list":[{"type":"DAG","name":"f2cf68f8_dag_cloned_1_cloned_1","description":"","attrs":{"type":"","edges":[]},"child_tasks_local_reference_list":[{"name":"Decommission_cloned_1","kind":"app_task"}],"variable_list":[],"target_any_local_reference":{"name":"Package1_cloned_0","kind":"app_package"},"timeout_secs":"0","retries":"0","inherit_target":false},{"type":"CALL_RUNBOOK","name":"Decommission_cloned_1","description":"","attrs":{"type":"CALL_RUNBOOK","runbook_reference":{"name":"3b04a9c4_runbook","kind":"app_runbook"},"inarg_list":[]},"child_tasks_local_reference_list":[],"variable_list":[],"target_any_local_reference":{"name":"Windows 2016","kind":"app_service"},"timeout_secs":"0","retries":"0","inherit_target":false}],"main_task_local_reference":{"name":"f2cf68f8_dag_cloned_1_cloned_1","kind":"app_task"},"variable_list":[]},"upgrade_runbook":{}}}],"app_profile_list":[{"name":"AHV","description":"","variable_list":[{"type":"LOCAL","name":"domain_name","description":"Enter domain name","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"Domain Name","attrs":{"type":""},"editables":{"value":true},"value":"automationlab.local"},{"type":"HTTP_LOCAL","name":"network","description":"Select network","options":{"type":"HTTP","attrs":{"type":"HTTP","method":"GET","connection_timeout":120,"headers":[],"url":"https:\/\/@@{infoblox_ip}@@\/wapi\/v2.7\/network?_return_fields%2B=extattrs&*Environment%3A=@@{environment}@@&*Automation=True","request_body":"","content_type":"application\/json","expected_response_params":[{"type":"","code":200,"status":"SUCCESS"},{"type":"","code":400,"status":"FAILURE"}],"authentication":{"type":"basic_with_cred","credential_local_reference":{"name":"infoblox","kind":"app_credential"}},"response_paths":{"network":"$[*].network"},"tls_verify":false,"proxy_type":"","retry_count":1,"retry_interval":1}},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"Network","attrs":{"type":""},"editables":{"value":true},"value":""},{"type":"LOCAL","name":"poc_type","description":"","options":{"type":"PREDEFINED","choices":["POC","NON-POC"]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":"LOCAL"},"editables":{"value":true},"value":"POC"},{"type":"LOCAL","name":"environment","description":"Select environment. This variable is used to determine which network(s) will be available.","options":{"type":"PREDEFINED","choices":["Dev","QA","Prod","Test","Lab"]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"Environment","attrs":{"type":"LOCAL"},"editables":{"value":true},"value":"Dev"},{"type":"LOCAL","name":"vm_name_prefix","description":"Enter prefix for VM naming.","options":{"type":"PREDEFINED","choices":[]},"is_hidden":false,"is_mandatory":true,"data_type":"BASE","val_type":"STRING","label":"Windows VM Naming Prefix","attrs":{"type":""},"editables":{"value":true},"value":"ahv"},{"type":"LOCAL","name":"infoblox_ip","description":"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":true,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"editables":{"value":false},"value":"10.54.27.19"},{"type":"LOCAL","name":"InstallSource","description":"","options":{"type":"PREDEFINED","choices":[]},"is_hidden":true,"is_mandatory":false,"data_type":"BASE","val_type":"STRING","label":"","attrs":{"type":""},"editables":{"value":false},"value":"\\\\windows-vm-725\\InstallSoftware"}],"action_list":[],"deployment_create_list":[{"type":"GREENFIELD","name":"d31b851c_deployment","description":"","variable_list":[],"action_list":[],"depends_on_list":[],"editables":{"default_replicas":true},"min_replicas":"1","max_replicas":"10","default_replicas":"1","package_local_reference_list":[{"name":"Package1_cloned_0","kind":"app_package"}],"substrate_local_reference":{"name":"Windows_AHV","kind":"app_substrate"},"published_service_local_reference_list":[]}],"snapshot_config_list":[],"restore_config_list":[],"environment_reference_list":[],"application_url":"","patch_list":[]}],"credential_definition_list":[{"type":"PASSWORD","name":"Local Administrator","description":"","username":"administrator","secret":{"attrs":{"secret_reference":{},"is_secret_modified":false}},"cred_class":"static"},{"type":"PASSWORD","name":"infoblox","description":"","username":"admin","secret":{"attrs":{"secret_reference":{},"is_secret_modified":false}},"cred_class":"static"},{"type":"PASSWORD","name":"Domain Join","description":"","username":"chris@automationlab.local","secret":{"attrs":{"secret_reference":{},"is_secret_modified":false}},"cred_class":"static"}],"default_credential_local_reference":{"name":"Local Administrator","kind":"app_credential"},"type":"USER","client_attrs":{"null":{"y":117,"x":669},"d31b851c_deployment":{"y":117,"x":669}}}},"api_version":"3.0","product_version":"3.8.1","metadata":{"last_update_time":"1733198401425310","creation_time":"1733174498022761","spec_version":12,"name":"CN-AHV-Windows-Infoblox","kind":"blueprint"},"contains_secrets":false}